<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <title>Firework Canvas</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Oswald:wght@200..700&display=swap"
            rel="stylesheet"
        />
        <style>
            body {
                margin: 0;
                overflow: hidden;
                background-color: #111; /* 어두운 배경 */
                font-family: Arial, sans-serif;
            }

            canvas {
                display: block;
                width: 100vw;
                height: 100vh;
                position: relative;
                z-index: 5;
            }
            .title-text {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 80px;
                font-family: "Montserrat", "Oswald", sans-serif;
                font-weight: 800;
                color: #fff;
                letter-spacing: 0.2em;
                pointer-events: none;
                z-index: 10;
                text-transform: uppercase;
                text-shadow: 
                    0 0 20px rgba(255, 255, 255, 0.8),
                    0 0 40px rgba(255, 255, 255, 0.6),
                    0 0 60px rgba(255, 255, 255, 0.4),
                    0 4px 8px rgba(0, 0, 0, 0.5),
                    0 8px 16px rgba(0, 0, 0, 0.3);
                -webkit-text-stroke: 1px rgba(255, 255, 255, 0.2);
                filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.6));
                animation: titlePulse 2s ease-in-out infinite;
            }
            @keyframes titlePulse {
                0%,
                100% {
                    opacity: 1;
                    transform: translate(-50%, -50%) scale(1);
                }
                50% {
                    opacity: 0.9;
                    transform: translate(-50%, -50%) scale(1.02);
                }
            }
        </style>
    </head>
    <body>
        <canvas id="fireworkCanvas"></canvas>
        <div class="title-text">CLICK!</div>

        <script>
            const canvasF = document.getElementById("fireworkCanvas");
            const ctxF = canvasF.getContext("2d");

            // 캔버스 크기 맞춤
            function resizeCanvas() {
                canvasF.width = window.innerWidth;
                canvasF.height = window.innerHeight;
            }
            resizeCanvas();
            window.addEventListener("resize", resizeCanvas);

            class ParticleF {
                constructor(
                    x,
                    y,
                    speedX,
                    speedY,
                    color,
                    size = 3,
                    gravity = 0.05
                ) {
                    this.x = x;
                    this.y = y;
                    this.speedX = speedX;
                    this.speedY = speedY;
                    this.color = color;
                    this.size = size;
                    this.gravity = gravity;
                    this.alpha = 1;
                }
                update() {
                    this.speedY += this.gravity;
                    this.x += this.speedX;
                    this.y += this.speedY;
                    this.speedX *= 0.98;
                    this.speedY *= 0.98;
                    this.size *= 0.97;
                    this.alpha -= 0.015;
                }
                draw() {
                    ctxF.fillStyle = `hsla(${this.color},100%,50%,${this.alpha})`;
                    ctxF.beginPath();
                    ctxF.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctxF.fill();
                }
            }

            class RocketF {
                constructor(targetX, targetY) {
                    this.x = canvasF.width / 2;
                    this.y = canvasF.height;
                    this.targetX = targetX;
                    this.targetY = targetY;
                    this.speedX = (targetX - this.x) / 60;
                    this.speedY = (targetY - this.y) / 60;
                    this.color = Math.random() * 360;
                    this.exploded = false;
                }
                update() {
                    if (!this.exploded) {
                        this.x += this.speedX;
                        this.y += this.speedY;
                        if (Math.abs(this.y - this.targetY) < 2) this.explode();
                    }
                }
                explode() {
                    this.exploded = true;
                    const count = 50 + Math.random() * 30;
                    for (let i = 0; i < count; i++) {
                        const angle = Math.random() * Math.PI * 2;
                        const speed = Math.random() * 4 + 2;
                        particlesF.push(
                            new ParticleF(
                                this.x,
                                this.y,
                                Math.cos(angle) * speed,
                                Math.sin(angle) * speed,
                                this.color,
                                Math.random() * 3 + 2,
                                0.05
                            )
                        );
                    }
                }
                draw() {
                    if (!this.exploded) {
                        ctxF.fillStyle = `hsl(${this.color},100%,50%)`;
                        ctxF.beginPath();
                        ctxF.arc(this.x, this.y, 3, 0, Math.PI * 2);
                        ctxF.fill();
                    }
                }
            }

            let rocketsF = [];
            let particlesF = [];
            canvasF.addEventListener("click", (e) =>
                rocketsF.push(new RocketF(e.clientX, e.clientY))
            );

            function animateF() {
                ctxF.fillStyle = "rgba(17,17,17,0.2)";
                ctxF.fillRect(0, 0, canvasF.width, canvasF.height);

                for (let i = 0; i < rocketsF.length; i++) {
                    rocketsF[i].update();
                    rocketsF[i].draw();
                    if (rocketsF[i].exploded) {
                        rocketsF.splice(i, 1);
                        i--;
                    }
                }

                for (let i = 0; i < particlesF.length; i++) {
                    particlesF[i].update();
                    particlesF[i].draw();
                    if (particlesF[i].size < 0.5 || particlesF[i].alpha <= 0) {
                        particlesF.splice(i, 1);
                        i--;
                    }
                }

                requestAnimationFrame(animateF);
            }
            animateF();
        </script>
    </body>
</html>
